# Отчёт по результатам анализа Kubernetes Audit Log

## Подозрительные события

### 1. Доступ к секретам
- **Кто:** `system:serviceaccount:secure-ops:monitoring` 
- **Где:** namespace `kube-system`, ресурс `secrets`, операция `list`
- **Почему подозрительно:**  
  Сервисный аккаунт мониторинга пытался получить доступ к секретам системного namespace. Доступ был **запрещён RBAC** (`authorization.k8s.io/decision=forbid`), что указывает либо на ошибочную конфигурацию, либо на попытку эскалации привилегий.

---

### 2. Привилегированные поды
- **Кто:** `minikube-user` (группа `system:masters`)
- **Комментарий:**  
  Зафиксировано создание Pod с `securityContext.privileged: true` (а также `allowPrivilegeEscalation`).  

---

### 3. Использование kubectl exec в чужом поде
- **Кто:** `minikube-user`
- **Что делал:**  
  Выполнена операция `pods/exec` в Pod `coredns-66bc5c9577-hntp6` в namespace `kube-system`.  
  Это системный pod, не принадлежащий пользователю напрямую. Доступ был разрешён за счёт членства в `system:masters`.

---

### 4. Создание RoleBinding с правами cluster-admin
- **Кто:** —
- **К чему привело:**  
  В анализируемом audit log **не обнаружено** операций `create` для ресурсов `rolebindings` или `clusterrolebindings`.  
  Фактов создания новых RBAC-привязок, в том числе с правами `cluster-admin`, не выявлено.

---

### 5. Удаление audit-policy.yaml
- **Кто:** —
- **Возможные последствия:**  
  Операции `delete` над объектами, связанными с `audit-policy`, **не зафиксированы**.  

---

## Вывод

- Попытка доступа сервисного аккаунта мониторинга к секретам была корректно заблокирована RBAC.
- Администратор (`system:masters`) создавал привилегированные pod'ы и выполнял `kubectl exec` в системных pod'ах
- audit-policy.yaml — файл удаляется на ноде действие не будет залогированно
- Создание RoleBinding манифест не отловит, так это группа rbac.authorization.k8s.io, в манифесте отлавливаются 
  только события из core API group. 

